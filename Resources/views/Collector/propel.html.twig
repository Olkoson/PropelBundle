{% extends '@WebProfiler/Profiler/layout.html.twig' %}

{% block toolbar %}
    {% if collector.querycount %}
        {% set icon %}
            <img alt="Propel" height="20" src="data:image/png;base64,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" />
            <span class="sf-toolbar-value">{{ collector.querycount }}</span>
            <span class="sf-toolbar-info-piece-additional-detail">
            <span class="sf-toolbar-label">in</span>
            <span class="sf-toolbar-value">{{ '%0.2f'|format(collector.time * 1000) }}</span>
            <span class="sf-toolbar-label">ms</span>
        </span>
        {% endset %}

        {% set text %}{% endset %}

        {{ include('@WebProfiler/Profiler/toolbar_item.html.twig', { link: profiler_url, status: status|default('') }) }}
    {% endif %}
{% endblock %}

{% block menu %}
    <span class="label{{ 0 == collector.querycount ? ' disabled' }}">
        <span class="icon"><img height="24" src="data:image/png;base64,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" alt="" /></span>
        <strong>Propel</strong>
    </span>
{% endblock %}

{% block panel %}
    {# the panel content #}
    <style type="text/css">
        .SQLKeyword {
            color: blue;
            white-space: nowrap;
        }
        .SQLName {
            color: #464646;
            white-space: nowrap;
        }
        .SQLInfo, .SQLComment {
            color: gray;
            display: block;
            font-size: 0.9em;
            margin: 3px 0;
        }

        .SQLExplain {
            margin: 5px;
        }

        .SQLExplain .error {
            background-color: #F2DEDE;
            border-color: #EED3D7;
            color: #B94A48;
            padding: 8px 35px 8px 14px;
            font-weight: bold;
        }

        #content .SQLExplain h2 {
            font-size: 17px;
            margin-bottom: 0;
        }
    </style>

    <h2>Queries</h2>
    <table summary="Show logged queries">
        <thead>
        <tr>
            <th>SQL queries</th>
        </tr>
        </thead>
        <tbody>
        {% if not collector.querycount %}
            <tr><td>No queries.</td></tr>
        {% else %}
            {% for i, query in collector.queries %}
                <tr>
                    <td>
                        <a name="propel-query-{{ i }}" ></a>
                        <code>{{ query.sql|format_sql }}</code>
                        {% if request.query.has('query') and request.query.get('query') == i %}
                            <div class="SQLExplain">
                                {% if constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION_ID') is defined and constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION_ID') >= 40400 %}
                                    {% set controllerPath = 'Propel\\Bundle\\PropelBundle\\Controller\\PanelController::explainAction' %}
                                {% else %}
                                    {% set controllerPath = 'PropelBundle\Panel:explain' %}
                                {% endif %}

                                {{ render(controller(controllerPath, {
                                    'token': token,
                                    'panel': 'propel',
                                    'query': request.query.get('query'),
                                    'connection': request.query.get('connection')
                                })) }}
                            </div>
                        {% endif %}
                        <div class="SQLInfo">
                            Time: {{ query.time }} - Memory: {{ query.memory }} - Connection: {{ query.connection }}

                            {% if request.query.get('query', -1) != i %}
                                - <a href="{{ path('_profiler', {'panel': 'propel', 'token': token, 'connection': query.connection, 'query': i}) }}#propel-query-{{ i }}">Explain the query</a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
        {% endif %}
        </tbody>
    </table>
    {{ constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION_ID') }}
    {% if constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION_ID') is defined and constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION_ID') >= 40400 %}
        {% set controllerPath = 'Propel\\Bundle\\PropelBundle\\Controller\\PanelController::configurationAction' %}
    {% else %}
        {% set controllerPath = 'PropelBundle:Panel:configuration' %}
    {% endif %}

    {{ render(controller(controllerPath)) }}
{% endblock %}
